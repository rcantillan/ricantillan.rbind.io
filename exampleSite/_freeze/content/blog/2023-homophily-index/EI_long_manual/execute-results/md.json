{
  "hash": "25a330831f00aa3feff96123a21f7e0a",
  "result": {
    "markdown": "---\ndate: 2023-08-10\n\ntitle: homophily II\nsubtitle: E-I index!\nauthor: Roberto Cantillan\n\nshow_post_date: true\nshow_author_byline: true\n\ndraft: false\n\nsummary: |\n    In this post I focus on analyzing homophily in a multidimensional way using the `ergm.ego` library, from the `statnet` group. For this I use the data from the Longitudinal Social Study of Chile (ELSOC).\n\nformat: hugo\n\nfreeze: auto\n---\n\n\nEn el presente documento se realiza un trabajo de datos para construir una base en formato long con la encuesta COES en su ola w2 y ola w4. Adicionalmente, se analizan datos panel con el modelo within-between (Bell & Jhones, 2014; Bell et al. 2019), ideales para el análisis de estructuras jerárquicas de datos, incluidos los datos datos de series de tiempo (de corte transversal), y de tipo panel. \n\nEl objetivo es explorar potenciales relaciones entre indicadores de homofilia y algunos indicadores de comportamiento cívico. El análisis de datos es realizado con el paquete panelr, diseñado para entorno R, el cual tiene como base el paquete lm4. Se prefiere el primero puesto que se reducen sustantivamente procedimientos y lineas de códigos y se obtienen los mismos resultados que si se realizará con el pquete lm4. \n\nPara revisar la base teórica del E-I index revisar el siguiente [link](https://redeslab.gitlab.io/manuales/ei_long_elsoc.html)\n\nPara atributos categóricos de los alter de la red ego, además de la proporción de alter similares a ego, una medida generalmente usada ha sido el índice EI (Krackhardt & Stern, 1988, Perry et al., 2018). Esta medida se define como el número de alter diferentes de ego (lazos externos E) menos el número de alter iguales a ego (lazos internos I), dividido por el número de alter. Esta es una medida “reversa” de homofilia toa vez que una medida alta de este índice índica mayor heterofilia. Además, debido a que es una transformación lineal de la medida de proporción de lazos homofilicos, su correlación es un perfecto -.1\n\n$$ EI = {\\frac {E - I}{E + I}}$$\n\nA continuación, desarrollamos el trabajo de código. Todo el análisis es realizado con datos de la encuesta ELSOC COES, considerando las olas 2 y 4. Las bases de datos y la documentación pueden ser descargadas desde el siguiente [link](https://dataverse.harvard.edu/dataverse/coes_data_repository) \n\n\n### Cargar librerias y bbdd\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggplot2, \n               ggthemes, \n               tidyverse, \n               sjlabelled,\n               sjPlot, \n               car, \n               vcd, \n               texreg, \n               ordinal,\n               nnet, \n               MASS, \n               mlogit, \n               matrixStats, \n               expss,\n               sjlabelled, \n               sjmisc, \n               tidyverse, \n               weights,\n               survey)\n```\n:::\n\n\n### Cargamos data\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"/home/rober/Documents/ricantillan.rbind.io/dat/ELSOC/ELSOC_W02_v3.00_R.RData\")\nload(\"/home/rober/Documents/ricantillan.rbind.io/dat/ELSOC/ELSOC_W04_v2.01_R.RData\")\n```\n:::\n\n\n### Subset 2017 \n\n::: {.cell}\n\n```{.r .cell-code}\n# Armar BBDD 2019 \nego2017 <- elsoc_2017 %>%\n  dplyr::select(idencuesta,\n                sexo=m0_sexo,\n                sexoalter01=r13_sexo_01,\n                sexoalter02=r13_sexo_02,\n                sexoalter03=r13_sexo_03,\n                sexoalter04=r13_sexo_04,\n                sexoalter05=r13_sexo_05,\n                edad=m0_edad,\n                edadalter01=r13_edad_01,\n                edadalter02=r13_edad_02,\n                edadalter03=r13_edad_03,\n                edadalter04=r13_edad_04,\n                edadalter05=r13_edad_05,\n                relig=m38,\n                religalter01=r13_relig_01,\n                religalter02=r13_relig_02,\n                religalter03=r13_relig_03,\n                religalter04=r13_relig_04,\n                religalter05=r13_relig_05,\n                educ=m01,\n                educalter01=r13_educ_01,\n                educalter02=r13_educ_02,\n                educalter03=r13_educ_03,\n                educalter04=r13_educ_04,\n                educalter05=r13_educ_05,\n                ideol=c15,\n                ideolalter01=r13_ideol_01,\n                ideolalter02=r13_ideol_02,\n                ideolalter03=r13_ideol_03,\n                ideolalter04=r13_ideol_04,\n                ideolalter05=r13_ideol_05,\n                c08_01,\n                c08_02,\n                c08_03,\n                c08_04,\n                ponderador01) \n```\n:::\n\n\n### Revisar BBDD\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017 <- data.frame(ego2017)\n#head(ego2017)\ndim(ego2017)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2473   36\n```\n:::\n\n```{.r .cell-code}\n# Definir NA's\nego2017[ego2017==\"-999\"] <- NA\nego2017[ego2017==\"-888\"] <- NA\n```\n:::\n\n\n### Recod variables 2017 \n\n#### Sexo\n\n::: {.cell}\n\n```{.r .cell-code}\nsexolab<-c(\"hombre\",\"mujer\")\nego2017$sexo_h<-factor(Recode(ego2017$sexo,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nego2017$alterSexo1<-factor(Recode(ego2017$sexoalter01,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nego2017$alterSexo2<-factor(Recode(ego2017$sexoalter02,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nego2017$alterSexo3<-factor(Recode(ego2017$sexoalter03,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nego2017$alterSexo4<-factor(Recode(ego2017$sexoalter04,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nego2017$alterSexo5<-factor(Recode(ego2017$sexoalter05,\"1=1;2=2;-888=NA;-999=NA\"),labels=sexolab)\nwith(ego2017, summary(cbind(alterSexo1,alterSexo2,alterSexo3,alterSexo4,alterSexo5)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   alterSexo1      alterSexo2      alterSexo3      alterSexo4   \n Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \n 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  \n Median :2.000   Median :2.000   Median :2.000   Median :2.000  \n Mean   :1.617   Mean   :1.583   Mean   :1.552   Mean   :1.546  \n 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  \n Max.   :2.000   Max.   :2.000   Max.   :2.000   Max.   :2.000  \n NA's   :1       NA's   :372     NA's   :864     NA's   :1370   \n   alterSexo5   \n Min.   :1.000  \n 1st Qu.:1.000  \n Median :2.000  \n Mean   :1.557  \n 3rd Qu.:2.000  \n Max.   :2.000  \n NA's   :1692   \n```\n:::\n:::\n\n\n#### Edad\n\n::: {.cell}\n\n```{.r .cell-code}\nedadlab <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \">65\")\nego2017$edadR<-factor(Recode(ego2017$edad,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\n\nego2017$alterAge1<-factor(Recode(ego2017$edadalter01,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\nego2017$alterAge2<-factor(Recode(ego2017$edadalter02,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\nego2017$alterAge3<-factor(Recode(ego2017$edadalter03,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\nego2017$alterAge4<-factor(Recode(ego2017$edadalter04,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\nego2017$alterAge5<-factor(Recode(ego2017$edadalter05,\"lo:24=1;25:34=2;35:44=3;45:54=4;55:64=5;65:hi=6\"),labels=edadlab)\nwith(ego2017, summary(cbind(alterAge1,alterAge2,alterAge3,alterAge4,alterAge5)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   alterAge1       alterAge2       alterAge3       alterAge4       alterAge5   \n Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.00  \n 1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.00  \n Median :4.000   Median :3.000   Median :3.000   Median :3.000   Median :3.00  \n Mean   :3.607   Mean   :3.376   Mean   :3.328   Mean   :3.312   Mean   :3.37  \n 3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.00  \n Max.   :6.000   Max.   :6.000   Max.   :6.000   Max.   :6.000   Max.   :6.00  \n NA's   :1       NA's   :372     NA's   :864     NA's   :1370    NA's   :1692  \n```\n:::\n:::\n\n\n#### Religión\n\n::: {.cell}\n\n```{.r .cell-code}\nrellab = c(\"Catolico\",\"Evangelico\",\"Otra Religion\",\"no religioso\")\nego2017$religid<-factor(Recode(ego2017$relig,\"1=1;2=2;3:6=3;7:9=4;-999:-888=4\"),labels=rellab)\nego2017$alterRelig1<-factor(Recode(ego2017$religalter01,\"1=1;2=2;3:4=4;5=3;-999:-888=4\"),labels=rellab)\nego2017$alterRelig2<-factor(Recode(ego2017$religalter02,\"1=1;2=2;3:4=4;5=3;-999:-888=4\"),labels=rellab)\nego2017$alterRelig3<-factor(Recode(ego2017$religalter03,\"1=1;2=2;3:4=4;5=3;-999:-888=4\"),labels=rellab)\nego2017$alterRelig4<-factor(Recode(ego2017$religalter04,\"1=1;2=2;3:4=4;5=3;-999:-888=4\"),labels=rellab)\nego2017$alterRelig5<-factor(Recode(ego2017$religalter05,\"1=1;2=2;3:4=4;5=3;-999:-888=4\"),labels=rellab)\nwith(ego2017, summary(cbind(alterRelig1,alterRelig2,alterRelig3,alterRelig4,alterRelig5)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  alterRelig1     alterRelig2     alterRelig3     alterRelig4   \n Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \n 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  \n Median :1.000   Median :1.000   Median :1.000   Median :1.000  \n Mean   :1.747   Mean   :1.762   Mean   :1.836   Mean   :1.784  \n 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  \n Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  \n NA's   :1       NA's   :372     NA's   :864     NA's   :1370   \n  alterRelig5   \n Min.   :1.000  \n 1st Qu.:1.000  \n Median :1.000  \n Mean   :1.809  \n 3rd Qu.:2.000  \n Max.   :4.000  \n NA's   :1692   \n```\n:::\n:::\n\n\n#### Educación\n\n::: {.cell}\n\n```{.r .cell-code}\nedulab = c(\"Basica\", \"Media\", \"Sup. Tecnica\", \"Sup. Univ\")\nego2017$educaF<-factor(Recode(ego2017$educ,\"1:3=1;4:5=2;6:7=3;8:10=4;-888=NA;-999=NA\"),labels=edulab)\nego2017$alterEduca1<-factor(Recode(ego2017$educalter01,\"1=1;2:3=2;4=3;5=4;-888=NA;-999=NA\"),labels=edulab)\nego2017$alterEduca2<-factor(Recode(ego2017$educalter02,\"1=1;2:3=2;4=3;5=4;-888=NA;-999=NA\"),labels=edulab)\nego2017$alterEduca3<-factor(Recode(ego2017$educalter03,\"1=1;2:3=2;4=3;5=4;-888=NA;-999=NA\"),labels=edulab)\nego2017$alterEduca4<-factor(Recode(ego2017$educalter04,\"1=1;2:3=2;4=3;5=4;-888=NA;-999=NA\"),labels=edulab)\nego2017$alterEduca5<-factor(Recode(ego2017$educalter05,\"1=1;2:3=2;4=3;5=4;-888=NA;-999=NA\"),labels=edulab)\nwith(ego2017, summary(cbind(alterEduca1,alterEduca2,alterEduca3,alterEduca4,alterEduca5)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  alterEduca1     alterEduca2     alterEduca3     alterEduca4   \n Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \n 1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  \n Median :2.000   Median :2.000   Median :2.000   Median :2.000  \n Mean   :2.344   Mean   :2.394   Mean   :2.438   Mean   :2.489  \n 3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:4.000  \n Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  \n NA's   :142     NA's   :481     NA's   :940     NA's   :1412   \n  alterEduca5   \n Min.   :1.000  \n 1st Qu.:2.000  \n Median :2.000  \n Mean   :2.454  \n 3rd Qu.:3.000  \n Max.   :4.000  \n NA's   :1724   \n```\n:::\n:::\n\n\n#### Posición Política\n\n::: {.cell}\n\n```{.r .cell-code}\npollab <- c(\"Izq\", \"Centro\", \"Der\", \"Ind/Ninguno\", \"NA\")\nego2017$izqderR<-factor(Recode(ego2017$ideol,\"0:3=1;4:6=2;7:10=3;11:12=4;NA=5\"),labels=pollab)\nego2017$alterPospol1=factor(Recode(ego2017$ideolalter01,\"1:2=3;3=2;4:5=1;6=4;NA=5\"),labels=pollab)\nego2017$alterPospol2=factor(Recode(ego2017$ideolalter02,\"1:2=3;3=2;4:5=1;6=4;NA=5\"),labels=pollab)\nego2017$alterPospol3=factor(Recode(ego2017$ideolalter03,\"1:2=3;3=2;4:5=1;6=4;NA=5\"),labels=pollab)\nego2017$alterPospol4=factor(Recode(ego2017$ideolalter04,\"1:2=3;3=2;4:5=1;6=4;NA=5\"),labels=pollab)\nego2017$alterPospol5=factor(Recode(ego2017$ideolalter05,\"1:2=3;3=2;4:5=1;6=4;NA=5\"),labels=pollab)\nwith(ego2017,summary(cbind(alterPospol1,alterPospol2,alterPospol3,alterPospol4,alterPospol5)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  alterPospol1   alterPospol2    alterPospol3    alterPospol4    alterPospol5  \n Min.   :1.00   Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  \n 1st Qu.:3.00   1st Qu.:3.000   1st Qu.:4.000   1st Qu.:4.000   1st Qu.:4.000  \n Median :4.00   Median :4.000   Median :4.000   Median :5.000   Median :5.000  \n Mean   :3.58   Mean   :3.747   Mean   :4.013   Mean   :4.318   Mean   :4.493  \n 3rd Qu.:4.00   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.000  \n Max.   :5.00   Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.000  \n```\n:::\n:::\n\n\n#### Tamaño de la red\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$tamred = as.numeric(!is.na(ego2017$sexoalter01)) + \n  as.numeric(!is.na(ego2017$sexoalter02)) +\n  as.numeric(!is.na(ego2017$sexoalter03)) + \n  as.numeric(!is.na(ego2017$sexoalter04)) +\n  as.numeric(!is.na(ego2017$sexoalter05))\nprint(prop.table(table(ego2017$tamred)), 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     0      1      2      3      4      5 \n0.0004 0.1500 0.1989 0.2046 0.1302 0.3158 \n```\n:::\n\n```{.r .cell-code}\ntable(ego2017$tamred)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  0   1   2   3   4   5 \n  1 371 492 506 322 781 \n```\n:::\n\n```{.r .cell-code}\n#Delete 1 persona with degree=0\nego2017$tamred[ego2017$tamred==0] <- NA\nsummary(ego2017$tamred)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n  1.000   2.000   3.000   3.263   5.000   5.000       1 \n```\n:::\n:::\n\n\n### Plot tamred \n#### posición política de alteres segun tamaño de la red de ego.\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$alterPospol1t<-Recode(ego2017$alterPospol1,\"1:2=3;3=2;4:5=1;6:5=4\")\nego2017$alterPospol2t<-Recode(ego2017$alterPospol2,\"1:2=3;3=2;4:5=1;6:5=4\")\nego2017$alterPospol3t<-Recode(ego2017$alterPospol3,\"1:2=3;3=2;4:5=1;6:5=4\")\nego2017$alterPospol4t<-Recode(ego2017$alterPospol4,\"1:2=3;3=2;4:5=1;6:5=4\")\nego2017$alterPospol5t<-Recode(ego2017$alterPospol5,\"1:2=3;3=2;4:5=1;6:5=4\")\n\nTpospol1=with(ego2017,table(tamred,alterPospol1t), na.rm=T)\nTpospol2=with(ego2017,table(tamred,alterPospol2t), na.rm=T)\nTpospol3=with(ego2017,table(tamred,alterPospol3t), na.rm=T)\nTpospol4=with(ego2017,table(tamred,alterPospol4t), na.rm=T)\nTpospol5=with(ego2017,table(tamred,alterPospol5t), na.rm=T)\n\nHpospol=Tpospol1+Tpospol2+Tpospol3+Tpospol4+Tpospol5\nHpospol=round(Hpospol, 0)\ndimnames(Hpospol)=list(tamred= c(\"1\", \"2\", \"3\", \"4\",\"5\"),\n                       alter = c(\"Izq\", \"Centro\", \"Der\", \"Ind/Ns\", \"NA\"))\n\nhom_tam<-as.data.frame(round(prop.table(Hpospol,1),2))\nggplot(data=hom_tam, aes(x=tamred, y=Freq, fill=alter, na.rm=T),  \n       weight = ponderador01) + \n  geom_bar(position = 'dodge', stat='identity') +\n  labs(title=\"Alter political position\", x=\"Network size\", y=\"\")+\n  scale_fill_grey()+\n  scale_y_continuous(limits = c(0, 1))+\n  theme_light()\n```\n\n::: {.cell-output-display}\n![](EI_long_manual.markdown_strict_files/figure-markdown_strict/unnamed-chunk-11-1.png){width=768}\n:::\n:::\n\n\n### Homofilia por posición política \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n#rec\nego2017$izqderRx<-Recode(ego2017$ideol,\"0:3=1;3:6=2;7:10=3;11:12=4;-999:-888=NA\")\nego2017$alterPospol1x=Recode(ego2017$ideolalter01,\"1:2=3;3=2;4:5=1;6=4;-999:-888=NA\")\nego2017$alterPospol2x=Recode(ego2017$ideolalter02,\"1:2=3;3=2;4:5=1;6=4;-999:-888=NA\")\nego2017$alterPospol3x=Recode(ego2017$ideolalter03,\"1:2=3;3=2;4:5=1;6=4;-999:-888=NA\")\nego2017$alterPospol4x=Recode(ego2017$ideolalter04,\"1:2=3;3=2;4:5=1;6=4;-999:-888=NA\")\nego2017$alterPospol5x=Recode(ego2017$ideolalter05,\"1:2=3;3=2;4:5=1;6=4;-999:-888=NA\")\n\nTpospol1=with(ego2017,table(izqderRx,alterPospol1x))\nTpospol2=with(ego2017,table(izqderRx,alterPospol2x))\nTpospol3=with(ego2017,table(izqderRx,alterPospol3x))\nTpospol4=with(ego2017,table(izqderRx,alterPospol4x))\nTpospol5=with(ego2017,table(izqderRx,alterPospol5x))\n\nHpospol=Tpospol1+Tpospol2+Tpospol3+Tpospol4+Tpospol5\nHpospol=round(Hpospol, 0)\ndimnames(Hpospol)=list(ego=c(\"Izq\", \"Centro\", \"Der\", \"Ind/Ns\"),\n                       alter=c(\"Izq\", \"Centro\", \"Der\", \"Ind/Ns\"))\nround(prop.table(Hpospol,1),2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        alter\nego       Izq Centro  Der Ind/Ns\n  Izq    0.41   0.04 0.10   0.45\n  Centro 0.14   0.10 0.14   0.61\n  Der    0.12   0.07 0.39   0.42\n  Ind/Ns 0.05   0.02 0.06   0.87\n```\n:::\n\n```{.r .cell-code}\nqq3<-as.data.frame(round(prop.table(Hpospol,1),2))\n\nggplot(data=qq3, aes(x=ego, y=Freq, fill=alter),  weight = ponderador01) + \n  geom_bar(position = 'dodge', stat='identity') +\n  labs(title=\"Political dyads\", x=\"Ego political position\", y=\"\")+\n  scale_fill_grey()+\n  scale_y_continuous(limits = c(0, 1))+\n    theme_light()\n```\n\n::: {.cell-output-display}\n![](EI_long_manual.markdown_strict_files/figure-markdown_strict/unnamed-chunk-12-1.png){width=768}\n:::\n:::\n\n\n### Cálculo E-I homofilia por posición política (ELSOC 2017)\n#### Indice E-I de Krackhardt y Stern (1988).\n\nCreamos  los alteres como externos (con otras categorías distinta a la del ego) o como internos (misma categoría que el ego). Los valores de -1 implican perfecta homofilia y los valores de +1 corresponden a perfecta heterofilia.\n\n### EI posición política\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$pospol_alt1_clasif<-ifelse(ego2017$izqderR==ego2017$alterPospol1,\"External\", \"Internal\")\nego2017$pospol_alt2_clasif<-ifelse(ego2017$izqderR==ego2017$alterPospol2,\"External\", \"Internal\")\nego2017$pospol_alt3_clasif<-ifelse(ego2017$izqderR==ego2017$alterPospol3,\"External\", \"Internal\")\nego2017$pospol_alt4_clasif<-ifelse(ego2017$izqderR==ego2017$alterPospol4,\"External\", \"Internal\")\nego2017$pospol_alt5_clasif<-ifelse(ego2017$izqderR==ego2017$alterPospol5,\"External\", \"Internal\")\n\n#Ahora se agrega la información sobre los tipos de vínculos\nego2017$pospol_external<-count_row_if(criterion = \"External\", \n                                        ego2017$pospol_alt1_clasif, \n                                        ego2017$pospol_alt2_clasif,\n                                        ego2017$pospol_alt3_clasif, \n                                        ego2017$pospol_alt4_clasif, \n                                        ego2017$pospol_alt5_clasif) \n\nego2017$pospol_internal<-count_row_if(criterion = \"Internal\", \n                                        ego2017$pospol_alt1_clasif, \n                                        ego2017$pospol_alt2_clasif,\n                                        ego2017$pospol_alt3_clasif, \n                                        ego2017$pospol_alt4_clasif, \n                                        ego2017$pospol_alt5_clasif) \n\n#Finalmente, calculamos el indicador EI\nego2017$EI_index_pospol<-(ego2017$pospol_external-ego2017$pospol_internal)/\n                         (ego2017$pospol_external+ego2017$pospol_internal)\n\nsummary(ego2017$EI_index_pospol)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n -1.000  -1.000  -0.600  -0.423  -0.200   1.000 \n```\n:::\n:::\n\n\n### EI religión\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$alterRelig1_clasif<-ifelse(ego2017$religid==ego2017$alterRelig1,\"External\",\"Internal\")\nego2017$alterRelig2_clasif<-ifelse(ego2017$religid==ego2017$alterRelig2,\"External\",\"Internal\")\nego2017$alterRelig3_clasif<-ifelse(ego2017$religid==ego2017$alterRelig3,\"External\",\"Internal\")\nego2017$alterRelig4_clasif<-ifelse(ego2017$religid==ego2017$alterRelig4,\"External\",\"Internal\")\nego2017$alterRelig5_clasif<-ifelse(ego2017$religid==ego2017$alterRelig5,\"External\",\"Internal\")\n\n#Ahora se agrega la información sobre los tipos de vínculos\nego2017$relig_external<-count_row_if(criterion = \"External\", \n                                     ego2017$alterRelig1_clasif, \n                                     ego2017$alterRelig2_clasif,\n                                     ego2017$alterRelig3_clasif, \n                                     ego2017$alterRelig4_clasif, \n                                     ego2017$alterRelig5_clasif) \n\nego2017$relig_internal<-count_row_if(criterion = \"Internal\", \n                                     ego2017$alterRelig1_clasif, \n                                     ego2017$alterRelig2_clasif,\n                                     ego2017$alterRelig3_clasif, \n                                     ego2017$alterRelig4_clasif, \n                                     ego2017$alterRelig5_clasif) \n\n#Finalmente, calculamos el indicador EI\nego2017$EI_index_relig<-(ego2017$relig_external-ego2017$relig_internal)/\n                        (ego2017$relig_external+ego2017$relig_internal)\n\nsummary(ego2017$EI_index_relig)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n-1.0000 -0.3333  0.6000  0.2776  1.0000  1.0000       8 \n```\n:::\n:::\n\n\n### EI educación\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$alterEduca1_clasif<-ifelse(ego2017$educaF==ego2017$alterEduca1,\"External\",\"Internal\")\nego2017$alterEduca2_clasif<-ifelse(ego2017$educaF==ego2017$alterEduca2,\"External\",\"Internal\")\nego2017$alterEduca3_clasif<-ifelse(ego2017$educaF==ego2017$alterEduca3,\"External\",\"Internal\")\nego2017$alterEduca4_clasif<-ifelse(ego2017$educaF==ego2017$alterEduca4,\"External\",\"Internal\")\nego2017$alterEduca5_clasif<-ifelse(ego2017$educaF==ego2017$alterEduca5,\"External\",\"Internal\")\n\n#Ahora se agrega la información sobre los tipos de vínculos\nego2017$educ_external<-count_row_if(criterion = \"External\", \n                                    ego2017$alterEduca1_clasif, \n                                    ego2017$alterEduca2_clasif,\n                                    ego2017$alterEduca3_clasif, \n                                    ego2017$alterEduca4_clasif, \n                                    ego2017$alterEduca5_clasif) \n\nego2017$educ_internal<-count_row_if(criterion = \"Internal\", \n                                    ego2017$alterEduca1_clasif, \n                                    ego2017$alterEduca2_clasif,\n                                    ego2017$alterEduca3_clasif, \n                                    ego2017$alterEduca4_clasif, \n                                    ego2017$alterEduca5_clasif) \n\n#Finalmente, calculamos el indicador EI\nego2017$EI_index_educ<-(ego2017$educ_external-ego2017$educ_internal)/\n                        (ego2017$educ_external+ego2017$educ_internal)\n\nsummary(ego2017$EI_index_educ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max.     NA's \n-1.00000 -1.00000  0.00000 -0.03621  0.60000  1.00000       59 \n```\n:::\n:::\n\n\n### EI Sexo\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$alterSexo1_clasif<-ifelse(ego2017$sexo_h==ego2017$alterSexo1,\"External\",\"Internal\")\nego2017$alterSexo2_clasif<-ifelse(ego2017$sexo_h==ego2017$alterSexo2,\"External\",\"Internal\")\nego2017$alterSexo3_clasif<-ifelse(ego2017$sexo_h==ego2017$alterSexo3,\"External\",\"Internal\")\nego2017$alterSexo4_clasif<-ifelse(ego2017$sexo_h==ego2017$alterSexo4,\"External\",\"Internal\")\nego2017$alterSexo5_clasif<-ifelse(ego2017$sexo_h==ego2017$alterSexo5,\"External\",\"Internal\")\n\n#Ahora se agrega la información sobre los tipos de vínculos\nego2017$sexo_external<-count_row_if(criterion = \"External\", \n                                    ego2017$alterSexo1_clasif, \n                                    ego2017$alterSexo2_clasif,\n                                    ego2017$alterSexo3_clasif, \n                                    ego2017$alterSexo4_clasif, \n                                    ego2017$alterSexo5_clasif) \n\nego2017$sexo_internal<-count_row_if(criterion = \"Internal\", \n                                    ego2017$alterSexo1_clasif, \n                                    ego2017$alterSexo2_clasif,\n                                    ego2017$alterSexo3_clasif, \n                                    ego2017$alterSexo4_clasif, \n                                    ego2017$alterSexo5_clasif) \n\n#Finalmente, calculamos el indicador EI\nego2017$EI_index_sexo<-(ego2017$sexo_external-ego2017$sexo_internal)/\n                       (ego2017$sexo_external+ego2017$sexo_internal)\n\nsummary(ego2017$EI_index_sexo)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n-1.0000 -0.2000  0.3333  0.2583  1.0000  1.0000       1 \n```\n:::\n:::\n\n\n### EI edad\n\n::: {.cell}\n\n```{.r .cell-code}\nego2017$alterAge1_clasif<-ifelse(ego2017$edadR==ego2017$alterAge1,\"External\",\"Internal\")\nego2017$alterAge2_clasif<-ifelse(ego2017$edadR==ego2017$alterAge2,\"External\",\"Internal\")\nego2017$alterAge3_clasif<-ifelse(ego2017$edadR==ego2017$alterAge3,\"External\",\"Internal\")\nego2017$alterAge4_clasif<-ifelse(ego2017$edadR==ego2017$alterAge4,\"External\",\"Internal\")\nego2017$alterAge5_clasif<-ifelse(ego2017$edadR==ego2017$alterAge5,\"External\",\"Internal\")\n\n#Ahora se agrega la información sobre los tipos de vínculos\nego2017$age_external<-count_row_if(criterion = \"External\", \n                                   ego2017$alterAge1_clasif, \n                                   ego2017$alterAge2_clasif,\n                                   ego2017$alterAge3_clasif, \n                                   ego2017$alterAge4_clasif, \n                                   ego2017$alterAge5_clasif) \n\nego2017$age_internal<-count_row_if(criterion = \"Internal\", \n                                   ego2017$alterAge1_clasif, \n                                   ego2017$alterAge2_clasif,\n                                   ego2017$alterAge3_clasif, \n                                   ego2017$alterAge4_clasif, \n                                   ego2017$alterAge5_clasif) \n\n#Finalmente, calculamos el indicador EI\nego2017$EI_index_age<-(abs(ego2017$age_external-ego2017$age_internal)/\n                      (ego2017$age_external+ego2017$age_internal))\n\nsummary(ego2017$EI_index_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n 0.0000  0.3333  0.6000  0.6177  1.0000  1.0000       1 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Ploteamos\npp<-ggplot(data=ego2017) + \n           geom_histogram(mapping = aes(x = EI_index_age), \n                          binwidth = 0.05, \n                          weight=\"ponderador01\") + \n           labs(title = \"Political homophily in personal networks\",\n           subtitle   = \"E-I homophily (Krackhardt & Stern, 1988)\",\n           caption    = \"source: ELSOC COES 2017\",\n           x = \"\", y = \"\")+\n  theme_light()\n\npp\n```\n\n::: {.cell-output-display}\n![](EI_long_manual.markdown_strict_files/figure-markdown_strict/unnamed-chunk-18-1.png){width=768}\n:::\n:::\n",
    "supporting": [
      "EI_long_manual.markdown_strict_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}